from pynput import keyboard
from Quartz import CGEventCreateKeyboardEvent, CGEventPost, kCGHIDEventTap
import time
import random

# MODIFIER KIA EXAMPLE
# When 'e' is pressed, inject Scroll Lock key, and when 'r' is pressed, inject Num Lock key.

KEY_SCROLL_LOCK = 107  # often used for Scroll Lock
KEY_NUM_LOCK = 71      # often used for Num Lock

def human_delay():
    time.sleep(random.uniform(0.04, 0.09))

def inject_key(key_code, name=""):
    print(f"Injecting {name} key")

    key_down = CGEventCreateKeyboardEvent(None, key_code, True)
    CGEventPost(kCGHIDEventTap, key_down)

    human_delay()

    key_up = CGEventCreateKeyboardEvent(None, key_code, False)
    CGEventPost(kCGHIDEventTap, key_up)

    human_delay()

    print(f"Injected {name} key with delay")

def on_press(key):
    try:
        if key.char == 'e':
            inject_key(KEY_SCROLL_LOCK, "Scroll Lock")
        elif key.char == 'r':
            inject_key(KEY_NUM_LOCK, "Num Lock")
    except AttributeError:
        pass

# Start listener
with keyboard.Listener(on_press=on_press) as listener:
    print("Listening for 'e' and 'r' keyâ€¦ Press Ctrl+C to exit.")
    listener.join()
